$(function(){const e=new DinnerModel,n=new GeneralController,t=new WelcomeView($("#welcomeView"),e),i=new SideBarView($("#sideBarView"),e),r=new DishSearchView($("#dishSearchView"),e),o=new DishDetailView($("#dishDetailView"),e),d=new DinnerOverviewView($("#dinnerOverviewView"),e),s=new TitleBarView($("#titleBarView"),e),l=new PrintView($("#printView"),e);n.addView(t).addView(i).addView(r).addView(o).addView(d).addView(s).addView(l);new WelcomeViewController(t,e,n),new SideBarViewController(i,e,n),new DishSearchViewController(r,e,n),new DishDetailsViewController(o,e,n),new DinnerOverviewViewController(d,e,n),new TitleBarViewController(s,e,n),new DishItemViewController($("#searchedDishes"),e,n);const c=["WELCOME","SELECT_DISH","DISH_DETAILS","DINNER_OVERVIEW","DINNER_PRINTOUT"];n.addOddElement("headLine",$("#headLine")),n.initOddElements(),n.addScreen("WELCOME",[t]).addScreen("SELECT_DISH",[i,r]).addScreen("DISH_DETAILS",[i,o]).addScreen("DINNER_OVERVIEW",[d,s]).addScreen("DINNER_PRINTOUT",[l,s]);let a={currentScreen:"",numberOfGuests:0,selectedDishes:[],searchCondition:[]};(()=>{let e=e=>{let n=e+"=",t=document.cookie.split(";");for(let e=0;e<t.length;e++){let i=t[e].trim();if(0==i.indexOf(n))return i.substring(n.length,i.length)}return""};if(0===document.cookie.length)for(key in a)a[key]=localStorage.getItem(key);else for(key in a)a[key]=e(key)})(),null!==a.selectedDishes&&(a.selectedDishes.split(",").forEach(n=>{e.addDishToMenu(n)}),e.setNumberOfGuests(Number(a.numberOfGuests)),r.setSearchCondition(...a.searchCondition.split(","))),n.setCurrentScreen(-1===c.indexOf(a.currentScreen)?"WELCOME":a.currentScreen),n.showScreen(n.getCurrentScreen()),window.addEventListener("unload",function(t){let i=n.getCurrentScreen(),o=e.getNumberOfGuests(),d=r.getSearchCondition();document.cookie="currentScreen="+i,document.cookie="numberOfGuests="+o;let s=[],l="";e.getSelectedDishes().forEach(e=>{s.push(e.id),l+=","+e.id}),l=l.substr(1),document.cookie="selectedDishes="+s,document.cookie="searchCondition="+d,localStorage.setItem("currentScreen",i),localStorage.setItem("numberOfGuests",o+""),localStorage.setItem("selectedDishes",l);let c=d[0]+","+d[1];for(key in localStorage.setItem("searchCondition",c),a)a[key]=localStorage.getItem(key)})});